<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Table with row/col span</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <style type="text/css">
        .aaa {
            margin: 0 auto;
            border-collapse: collapse;
            border: 1px solid black;
            font: 12px/12px "Times New Roman" black;
            width: 500px;
        }

            .aaa th {
                border: 1px solid black;
                background-color: #ffd800;
            }

            .aaa td {
                border: 1px solid black;
            }
    </style>
    <script type="text/javascript">
        function Init(tableId) {
            var t = document.getElementById(tableId);
            var rows = t.rows;
            for (var i = 0; i < rows[0].cells.length; i++) {
                rows[0].cells[i].addEventListener('click', Sort, true);
            }
            function Sort(e) {
                e.preventDefault();
                e.stopPropagation();
                if (this.className.indexOf('asc') == -1) {
                    this.className = 'asc';
                    var span,
                        tabl = this.offsetParent,
                        rows = Array.prototype.slice.call(tabl.rows),
                        col = [];
                    rows.shift();
                    for (var i = 0; i < rows.length; i++) {
                        if (span) {
                            col[i] = rows[i].cells[this.cellIndex - 1];
                            span--;
                        }
                        else {
                            if (rows[i].querySelector('[rowspan]')) {
                                var spanned = rows[i].querySelector('[rowspan]');
                                span = rows[i].querySelector('[rowspan]').rowSpan - 1;
                            }
                            col[i] = rows[i].cells[this.cellIndex];
                        }
                    }
                    col.sort(SortAsc);
                    console.log('array sorted: ', col);
                }
                else {
                    this.className = 'desc';
                    var span,
                        tabl = this.offsetParent,
                        rows = Array.prototype.slice.call(tabl.rows),
                        col = [];
                    rows.shift();
                    for (var i = 0; i < rows.length; i++) {
                        if (span) {
                            col[i] = rows[i].cells[this.cellIndex - 1];
                            span--;
                        }
                        else {
                            if (rows[i].querySelector('[rowspan]'))
                                span = { rowNum: i, q: rows[i].querySelector('[rowspan]').rowSpan };
                            col[i] = rows[i].cells[this.cellIndex];
                        }
                    }
                    col.sort(SortDesc);
                    console.log('array sorted: ', col);
                }
                function SortAsc() {
                    return function (a, b) {
                        if (isNumber(a.textContent) && isNumber(b.textContent)) {
                            var a = Number(a.textContent),
                                b = Number(b.textContent);
                            return a === b ? 0 : (a < b ? -1 : 1);
                        }
                        else return a.textContent.localeCompare(b.textContent);
                    }
                }
                function SortDesc() {
                    return function (a, b) {
                        if (isNumber(a.textContent) && isNumber(b.textContent)) {
                            var a = Number(a.textContent),
                            b = Number(b.textContent);
                            return a === b ? 0 : (b < a ? -1 : 1);
                        }
                        else return -a.textContent.localeCompare(b.textContent);
                    }
                }
                function isNumber(value) {
                    if (!isNaN(parseFloat(value)) && isFinite(value))
                        return true;
                    else return false;
                }
            }
        }
    </script>
</head>
<body>
    <div id="wrapper">
        <table class="aaa" id="aa">
            <thead>
                <tr>
                    <th><a href="#">Date</a></th>
                    <th><a href="#">Quant.</a></th>
                    <th><a href="#">Text</a></th>
                    <th><a href="#">Last</a></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>02-jan-2014</td>
                    <td>25</td>
                    <td>Test 1</td>
                    <td></td>
                </tr>
                <tr>
                    <td rowspan="2">02-feb-2014</td>
                    <td>30</td>
                    <td>Text 2</td>
                    <td></td>
                </tr>
                <tr>
                    <td>15</td>
                    <td>Text 3</td>
                    <td></td>
                </tr>
                <tr>
                    <td>02-jun-2014</td>
                    <td>45</td>
                    <td>Text 4</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>
</body>
</html>