<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Table with row/col span</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <style type="text/css">
        .aaa {
            margin: 0 auto;
            border-collapse: collapse;
            border: 1px solid black;
            font: 12px/12px "Times New Roman" black;
            width: 500px;
        }

            .aaa th {
                border: 1px solid black;
                background-color: #ffd800;
            }

            .aaa td {
                border: 1px solid black;
            }
    </style>
    <script type="text/javascript">
        function Init(tableId) {
            var t = document.getElementById(tableId);
            var rows = t.rows;
            for (var i = 0; i < rows[0].cells.length; i++) {
                rows[0].cells[i].addEventListener('click', Sort, true);
            }
            function Sort(e) {
                e.preventDefault();
                e.stopPropagation();
                if (this.className.indexOf('asc') == -1) {
                    this.className = 'asc';
                    var rows = Array.prototype.slice.call(this.offsetParent.rows),
                        col = [];
                    rows.shift();
                    for (var i = 0; i < rows.length; i++) {
                        if (rows[i].querySelector('[rowspan]')) {
                            var spancell = rows[i].querySelector('[rowspan]');
                            if (spancell.cellIndex === rows[i].cells[this.cellIndex].cellIndex) {
                                col[i] = rows[i].cells[this.cellIndex];
                            }
                            else {
                                var temparr = [];
                                temparr[0] = rows[i].cells[this.cellIndex]
                                for (var s = 1; s < spancell.rowSpan; s++) {
                                    if (spancell.cellIndex < this.cellIndex)
                                        temparr[s] = rows[i + s].cells[this.cellIndex - 1];
                                    else temparr[s] = rows[i + s].cells[this.cellIndex];
                                }
                                temparr.sort(SortAsc());
                                col[i] = temparr[0];
                            }
                            i += spancell.rowSpan - 1;
                        }
                        else col.push(rows[i].cells[this.cellIndex]);
                    }
                    col.sort(SortAsc());
                    console.log(col);
                }
                else {
                    this.className = 'desc';
                    var rows = Array.prototype.slice.call(this.offsetParent.rows),
                        col = [];
                    rows.shift();
                    for (var i = 0; i < rows.length; i++) {
                        if (rows[i].querySelector('[rowspan]')) {
                            var spancell = rows[i].querySelector('[rowspan]');
                            if (spancell.cellIndex === this.cellIndex) {
                                col[i] = rows[i].cells[this.cellIndex];
                            }
                            else {
                                var temparr = [];
                                temparr[0] = rows[i].cells[this.cellIndex]
                                for (var s = 1; s < spancell.rowSpan; s++) {
                                    if (spancell.cellIndex < this.cellIndex)
                                        temparr[s] = rows[i + s].cells[this.cellIndex - 1];
                                    else temparr[s] = rows[i + s].cells[this.cellIndex];
                                }
                                temparr.sort(SortDesc());
                                moveRows(spancell, temparr);
                                for (var j in temparr)
                                    col.push(temparr[j]);
                            }
                            i += spancell.rowSpan - 1;
                        }
                        else col.push(rows[i].cells[this.cellIndex]);
                    }
                    col.sort(SortDesc());
                    moveRows(this.offsetParent, col);
                    console.log(col);
                }
                function SortAsc() {
                    return function (a, b) {
                        if (isNumber(a.textContent) && isNumber(b.textContent)) {
                            var a = Number(a.textContent),
                                b = Number(b.textContent);
                            return a === b ? 0 : (a < b ? -1 : 1);
                        }
                        else return a.textContent.localeCompare(b.textContent);
                    }
                }
                function SortDesc() {
                    return function (a, b) {
                        if (isNumber(a.textContent) && isNumber(b.textContent)) {
                            var a = Number(a.textContent),
                                b = Number(b.textContent);
                            return a === b ? 0 : (b < a ? -1 : 1);
                        }
                        else return -a.textContent.localeCompare(b.textContent);
                    }
                }
                function isNumber(value) {
                    if (!isNaN(parseFloat(value)) && isFinite(value))
                        return true;
                    else return false;
                }
                function moveRows(elem, tdsArr) {
                    var index = tdsArr[i].parentNode.rowIndex,
                        spancell = tdsArr[i].parentNode.querySelector('[rowspan]');
                    for (var i = 0; i < tdsArr.length; i++) {
                        if (elem.hasAttribute('rowspan')) {
                            for (var i = 0; i < tdsArr.length; i++) {
                                if (index !== spancell.parentNode.rowIndex + i) {

                                }
                            }
                        }
                        else {
                            if (index !== i + 1) {
                                if (i + 1 > index) {
                                    if (spancell) {
                                        for (var j = 0; j < spancell.rowSpan; j++) {
                                            elem.rows[i + 1].parentNode.insertBefore(elem.rows[index], elem.rows[i + 2]);
                                        }
                                    }
                                    else elem.rows[i + 1].parentNode.insertBefore(elem.rows[index], elem.rows[i + 2]);
                                }
                                else {
                                    if (spancell) {
                                        for (var j = 0; j < spancell.rowSpan; j++) {
                                            elem.rows[i + 1].parentNode.insertBefore(elem.rows[index], elem.rows[i + 1]);
                                        }
                                    }
                                    else elem.rows[i + 1].parentNode.insertBefore(elem.rows[index], elem.rows[i + 1]);
                                }
                            }
                        }
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div id="wrapper">
        <table class="aaa" id="aa">
            <thead>
                <tr>
                    <th><a href="#">Date</a></th>
                    <th><a href="#">Quant.</a></th>
                    <th><a href="#">Text</a></th>
                    <th><a href="#">Last</a></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>2/01/2014</td>
                    <td>25</td>
                    <td>Test 1</td>
                    <td></td>
                </tr>
                <tr>
                    <td rowspan="2">2/02/2014</td>
                    <td>30</td>
                    <td>Text 2</td>
                    <td></td>
                </tr>
                <tr>
                    <td>15</td>
                    <td>Text 3</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2/06/2014</td>
                    <td>45</td>
                    <td>Text 4</td>
                    <td></td>
                </tr>
                <tr>
                    <td>5/01/2014</td>
                    <td>10</td>
                    <td>Text 5</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2/04/2014</td>
                    <td>75</td>
                    <td>Text 6</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>
</body>
</html>